{"version":3,"sources":["webpack:///webpack/bootstrap a4072dda2249ea92fa29","webpack:///external \"express\"","webpack:///external \"os\"","webpack:///./server/common/logger.js","webpack:///./server/api/services/converter.service.js","webpack:///./server/index.js","webpack:///./server/common/env.js","webpack:///external \"dotenv\"","webpack:///./server/common/server.js","webpack:///external \"path\"","webpack:///external \"body-parser\"","webpack:///external \"http\"","webpack:///external \"cookie-parser\"","webpack:///external \"cors\"","webpack:///external \"pino\"","webpack:///./server/routes.js","webpack:///./server/api/controllers/downloadContent/router.js","webpack:///./server/api/controllers/downloadContent/controller.js","webpack:///external \"phantom-html-to-pdf\"","webpack:///./server/api/controllers/saveContent/router.js","webpack:///./server/api/controllers/saveContent/controller.js","webpack:///external \"fs\""],"names":["l","name","process","env","APP_ID","level","LOG_LEVEL","phantomHtmlToPdfConverter","ConverterService","constructor","htmlToPdfConverter","convertHtmlToPdf","getPdfStreamFromHtml","html","Promise","resolve","reject","err","pdf","stream","router","listen","PORT","config","path","bodyParser","http","os","app","ExpressServer","root","normalize","__dirname","set","use","json","urlencoded","extended","SESSION_SECRET","static","routes","port","welcome","p","info","hostname","createServer","URL_PATH","VERSION_ONE","express","Router","post","asHTML","asMarkdown","asPDF","setContentTypeWithDispositionHeader","callback","type","disposition","call","DownloadContentController","req","res","body","filename","Date","now","status","send","then","setHeader","pipe","catch","write","end","markdown","TEMP_DIR_PATH","tmpdir","SaveContentController","output","createWriteStream","writable","download"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a4072dda2249ea92fa29","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"os\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"os\"\n// module id = 1\n// module chunks = 0","import pino from 'pino';\n\nconst l = pino({\n  name: process.env.APP_ID,\n  level: process.env.LOG_LEVEL,\n});\n\nexport default l;\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/logger.js","import phantomHtmlToPdfInit from 'phantom-html-to-pdf';\n\nconst phantomHtmlToPdfConverter = phantomHtmlToPdfInit();\n\n// Export part\nclass ConverterService {\n  constructor(htmlToPdfConverter) {\n    this.convertHtmlToPdf = htmlToPdfConverter;\n  }\n\n  getPdfStreamFromHtml(html) {\n    return new Promise((resolve, reject) => {\n      this.convertHtmlToPdf({ html }, (err, pdf) => {\n        if (err) {\n          reject(err);\n        } else {\n          resolve(pdf.stream);\n        }\n      });\n    });\n  }\n}\n\nexport default new ConverterService(phantomHtmlToPdfConverter);\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/services/converter.service.js","import './common/env';\nimport Server from './common/server';\nimport routes from './routes';\n\nexport default new Server()\n  .router(routes)\n  .listen(process.env.PORT);\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","import dotenv from 'dotenv';\n\ndotenv.config();\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/env.js","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 7\n// module chunks = 0","import Express from 'express';\nimport * as path from 'path';\nimport * as bodyParser from 'body-parser';\nimport * as http from 'http';\nimport * as os from 'os';\nimport cookieParser from 'cookie-parser';\nimport cors from 'cors';\n// import swaggerify from './swagger';\nimport l from './logger';\n\nconst app = new Express();\n\nexport default class ExpressServer {\n  constructor() {\n    const root = path.normalize(`${__dirname}/../..`);\n    app.set('appPath', `${root}client`);\n    app.use(cors());\n    app.use(bodyParser.json());\n    app.use(bodyParser.urlencoded({ extended: true }));\n    app.use(cookieParser(process.env.SESSION_SECRET));\n    app.use(Express.static(`${root}/public`));\n  }\n\n  router(routes) {\n    routes(app);\n    // swaggerify(app, routes);\n    return this;\n  }\n\n  listen(port = process.env.PORT) {\n    const welcome = p => () => l.info(`up and running in ${process.env.NODE_ENV || 'development'} @: ${os.hostname()} on port: ${p}}`);\n    http.createServer(app).listen(port, welcome(port));\n    return app;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/server.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"pino\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pino\"\n// module id = 14\n// module chunks = 0","import downloadContent from './api/controllers/downloadContent/router';\nimport saveContent from './api/controllers/saveContent/router';\n\nconst URL_PATH = '/api';\nconst VERSION_ONE = '/v1';\n\nexport default function routes(app) {\n  app.use(`${URL_PATH + VERSION_ONE}/download`, downloadContent);\n  app.use(`${URL_PATH + VERSION_ONE}/save`, saveContent);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes.js","import * as express from 'express';\nimport Download from './controller';\n\nexport default express\n  .Router()\n  .post('/ashtml', Download.asHTML)\n  .post('/asmarkdown', Download.asMarkdown)\n  .post('/aspdf', Download.asPDF);\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/downloadContent/router.js","import ConvertService from '../../services/converter.service';\n// import logger from '../../../common/logger';\n\n/**\n * Set content type header and disposition header.\n * It is mainly used in combination with content download.\n *\n * @param { function } callback\n * @param { string } type\n * @param { string } disposition\n */\nfunction setContentTypeWithDispositionHeader(callback, type, disposition) {\n  callback.call(this, 'Content-disposition', disposition);\n  callback.call(this, 'Content-type', type);\n}\n\n/**\n * Sends the raw content as response so the client can handle the state.\n */\nclass DownloadContentController {\n  /**\n   * Convert html to pdf and return the raw pdf.\n   *\n   * @param {object} req\n   * @param {object} res\n   */\n  asPDF(req, res) {\n    const html = req.body.html;\n    const filename = req.body.filename || Date.now();\n\n    if (!html) {\n      res.status(400).send('No html as param send.');\n    }\n\n    ConvertService.getPdfStreamFromHtml(html)\n      .then(stream => {\n        setContentTypeWithDispositionHeader.call(\n          res,\n          res.setHeader,\n          'application/pdf;',\n          `attachment; filename=${filename}.pdf`,\n        );\n\n        stream.pipe(res);\n        res.status(201);\n      })\n      .catch(err => {\n        res.status(500).send(`A Error occured while converting: ${err}`);\n      });\n  }\n\n  /**\n   * TODO this method doesn't make sense the client can download the html.\n   * TODO but leave it if we decide to do some styling.\n   *\n   * @param {object} req\n   * @param {object} res\n   */\n  asHTML(req, res) {\n    const html = req.body.html;\n    const filename = req.body.filename || Date.now();\n\n    if (!html) {\n      res.status(400).send('No html as param send.');\n    }\n\n    setContentTypeWithDispositionHeader.call(\n      res,\n      res.setHeader,\n      'text/html; charset=UTF-8',\n      `attachment; filename=${filename}.html`,\n    );\n\n    res.write(html);\n    res.end();\n  }\n\n  /**\n   * TODO this method doesn't make sense the client can download the markdown.\n   * TODO but leave it if we decide to do some styling.\n   *\n   * @param {object} req\n   * @param {object} res\n   */\n  asMarkdown(req, res) {\n    const markdown = req.body.markdown;\n    const filename = req.body.filename || Date.now();\n\n    if (!markdown) {\n      res.status(400).send('No markdown as param send.');\n    }\n\n    setContentTypeWithDispositionHeader.call(\n      res,\n      res.setHeader,\n      'text/markdown; charset=UTF-8',\n      `attachment; filename=${filename}.md`,\n    );\n\n    res.write(markdown);\n    res.end();\n  }\n}\n\nexport default new DownloadContentController();\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/downloadContent/controller.js","module.exports = require(\"phantom-html-to-pdf\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"phantom-html-to-pdf\"\n// module id = 18\n// module chunks = 0","import * as express from 'express';\nimport Save from './controller';\n\nexport default express\n  .Router()\n  .post('/ashtml', Save.asHTML)\n  .post('/asmarkdown', Save.asMarkdown)\n  .post('/aspdf', Save.asPDF);\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/saveContent/router.js","import os from 'os';\nimport filesystem from 'fs';\nimport ConvertService from '../../services/converter.service';\nimport logger from '../../../common/logger';\n\n/**\n * Tempory directory path.\n */\nconst TEMP_DIR_PATH = os.tmpdir();\n\n/**\n * Set content type header and disposition header.\n * It is mainly used in combination with content download.\n *\n * @param { function } callback\n * @param { string } type\n * @param { string } disposition\n */\nfunction setContentTypeWithDispositionHeader(callback, type, disposition) {\n  callback.call(this, 'Content-disposition', disposition);\n  callback.call(this, 'Content-type', type);\n}\n\n/**\n * Manages the saving of the content and providing the save url so it can be\n * managed by the client.\n */\nclass SaveContentController {\n  /**\n   * Save data as PDF file.\n   *\n   * @param  {object} req\n   * @param  {object} res\n   */\n  asPDF(req, res) {\n    const html = req.body.html;\n    const filename = req.body.filename || Date.now();\n    const path = `${(req.body.path || TEMP_DIR_PATH)}/${filename}.pdf`;\n\n    if (!html) {\n      res.status(400).send('No html as param send.');\n    }\n\n    ConvertService.getPdfStreamFromHtml(html)\n      .then(stream => {\n        const output = filesystem.createWriteStream(path);\n\n        if (!output.writable) {\n          res.status(403).send(`The temp direcori is not writable ${path}`);\n        }\n\n        setContentTypeWithDispositionHeader.call(\n          res,\n          res.setHeader,\n          'text/plain',\n          `attachment; filename=${filename}.pdf`,\n        );\n\n        stream.pipe(output);\n        res.status(201).send(path);\n      })\n      .catch(err => {\n        res.status(500).send(`A Error occured while converting: ${err}`);\n      });\n  }\n\n\n  /**\n   * Save data as HTML file.\n   *\n   * @param  {object} req\n   * @param  {object} res\n   */\n  asHTML(req, res) {\n    const html = req.body.html;\n    const filename = req.body.filename || Date.now();\n    const path = `${(req.body.path || TEMP_DIR_PATH)}/${filename}.pdf`;\n\n    if (!html) {\n      res.status(400).send('No html as param send.');\n    }\n\n    setContentTypeWithDispositionHeader.call(\n      res,\n      res.setHeader,\n      'text/html; charset=UTF-8',\n      `attachment; filename=${filename}.html`,\n    );\n\n    res.download(path, `${filename}.html`, () => {\n      res.status(201).send(html);\n    });\n  }\n\n  /**\n   * Save data as Markdown file.\n   *\n   * @param {object} req\n   * @param {object} res\n   */\n  asMarkdown(req, res) {\n    const markdown = req.body.markdown;\n    const filename = req.body.filename || Date.now();\n    const path = `${(req.body.path || TEMP_DIR_PATH)}/${filename}.pdf`;\n\n    if (!markdown) {\n      res.status(400).send('No markdown as param send.');\n    }\n\n    setContentTypeWithDispositionHeader.call(\n      res,\n      res.setHeader,\n      'text/markdown; charset=UTF-8',\n      `attachment; filename=${filename}.md`,\n    );\n\n    res.download(path, `${filename}.md`, () => {\n      res.status(201).send(markdown);\n    });\n  }\n}\n\nexport default new SaveContentController();\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/api/controllers/saveContent/controller.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 21\n// module chunks = 0"],"sourceRoot":""}